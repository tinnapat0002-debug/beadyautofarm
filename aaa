--========================================================
--              FLUENT UI AUTO FARM SYSTEM               
--========================================================

local Fluent = loadstring(game:HttpGet("https://github.com/dawid-scripts/Fluent/releases/latest/download/main.lua"))()

local Window = Fluent:CreateWindow({
    Title = "Auto Fishing System",
    SubTitle = "Full Auto Fishing",
    TabWidth = 160,
    Size = UDim2.fromOffset(580, 460),
    Acrylic = true,
    Theme = "Dark",
    MinimizeKey = Enum.KeyCode.LeftControl
})

local Tabs = {
    Main = Window:AddTab({ Title = "üè† Main", Icon = "home" }),
    Info = Window:AddTab({ Title = "‚ÑπÔ∏è Info", Icon = "info" })
}

local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local player = Players.LocalPlayer

-- Global Variables
local AutoFarmEnabled = _G.CONFIG.AutoFarmOnStart

local isFishing = false
local isSelling = false
local isTeleporting = false
local isBuyingBait = false
local isBuyingFood = false

--========================================================
--                  HELPER FUNCTIONS                     
--========================================================

local function createFishingPlatform()
    pcall(function()
        local oldPart = workspace:FindFirstChild("FishingPlatform")
        if oldPart then
            oldPart:Destroy()
        end
        
        local part = Instance.new("Part")
        part.Name = "FishingPlatform"
        part.CFrame = CFrame.new(-671, 18, -2950)
        part.Anchored = true
        part.Size = Vector3.new(10, 2, 10)
        part.Transparency = 0.5
        part.CanCollide = true
        part.Parent = workspace
        
        print("‚úÖ Created fishing platform")
    end)
end

local function ensureFishingRod()
    local hasRod = false
    
    pcall(function()
        local playerName = player.Name
        if workspace:FindFirstChild(playerName) and workspace[playerName]:FindFirstChild("FishingRod") then
            hasRod = true
            print("‚úÖ Already has fishing rod")
        end
    end)
    
    if not hasRod then
        print("‚ö†Ô∏è No fishing rod found - Equipping...")
        pcall(function()
            local args = {"FishingRod", "", ""}
            game.Lighting:WaitForChild("Sky"):WaitForChild("Optimized"):FireServer(unpack(args))
        end)
        task.wait(1)
        print("‚úÖ Equipped fishing rod")
    end
end

--========================================================
--                  FISHING FUNCTIONS                     
--========================================================

local function toggleFishingRod()

    pcall(function()
        local args = {"FishingRod", "", ""}
        game.Lighting:WaitForChild("Sky"):WaitForChild("Optimized"):FireServer(unpack(args))
    end)
end

local function getCurrentWeight()
    local success, weightText = pcall(function()
        return player.PlayerGui["Inventory1.5"].Frame.Main.Frame.Frame.TextLabel.Text
    end)
    
    if success and weightText then
        local currentWeight = tonumber(string.match(weightText, "([%d%.]+)/"))
        return currentWeight, weightText
    end
    
    return nil, nil
end

local function getBaitAmount()
    local amount = 0
    pcall(function()
        local baitItem = player.PlayerGui["Inventory1.5"].Frame.Main.ScrollingFrame.Scrolling:FindFirstChild("Bait")
        if baitItem then
            amount = tonumber(baitItem:GetAttribute("value")) or 0
        end
    end)
    return amount
end

local function getFishAmount(fishName)
    local amount = 0
    pcall(function()
        local fishItem = player.PlayerGui["Inventory1.5"].Frame.Main.ScrollingFrame.Scrolling:FindFirstChild(fishName)
        if fishItem then
            amount = tonumber(fishItem:GetAttribute("value")) or 0
        end
    end)
    return amount
end

local function buyBait()
    isBuyingBait = true
    
    local SHOP_POSITION = Vector3.new(7794,265, -785)
    
    for i = 1, 3 do
        pcall(function()
            local character = player.Character or player.CharacterAdded:Wait()
            local hrp = character:WaitForChild("HumanoidRootPart")
            hrp.CFrame = CFrame.new(SHOP_POSITION)
        end)
        task.wait(1)
    end
    
    task.wait(1.5)

    pcall(function()
        local character = player.Character
        local hrp = character and character:FindFirstChild("HumanoidRootPart")
        if not hrp then return end

        local targetPrompt = nil
        local shortestDistance = math.huge

        for _, item in ipairs(workspace.AMain.Market_:GetChildren()) do
            local prompt = item:FindFirstChild("MarketPrompt")
            if prompt and prompt:IsA("ProximityPrompt") then
                pcall(function()
                    local promptPos = item:IsA("BasePart") and item.Position or item.WorldPosition
                    local distance = (hrp.Position - promptPos).Magnitude
                    
                    if distance < shortestDistance then
                        shortestDistance = distance
                        targetPrompt = prompt
                    end
                end)
            end
        end

        if targetPrompt then
            fireproximityprompt(targetPrompt)
        end
    end)
    
    task.wait(2)
    
    pcall(function()
        local args = {
            "Money",
            {
                Bait = {
                    Price = 10,
                    Amount = 10
                }
            }
        }
        player.PlayerGui.Shop.LocalScript.RemoteEvent:FireServer(unpack(args))
    end)
    
    task.wait(2)
    
    pcall(function()
        local args = { "Close" }
        player.PlayerGui.Shop.LocalScript.RemoteEvent:FireServer(unpack(args))
    end)
    
    isBuyingBait = false
end

local function teleportToFishingSpot()
    while isTeleporting or isSelling or isBuyingBait or isBuyingFood do
        task.wait(1)
    end
    
    isTeleporting = true
    
    createFishingPlatform()
    
    task.wait(0.5)
    
    local pos = CFrame.new(-671, 18, -2950)
    
    for i = 1, 3 do
        pcall(function()
            local character = player.Character or player.CharacterAdded:Wait()
            local hrp = character:WaitForChild("HumanoidRootPart")
            hrp.CFrame = pos
        end)
        task.wait(2)
    end
    
    isTeleporting = false
    print("‚úÖ Teleported to fishing spot")
    task.wait(2)
end

local function startFishing()
    print("üé£ Starting fishing process...")

    ensureFishingRod()
    task.wait(1)

    -- Teleport
    teleportToFishingSpot()
    task.wait(2)
    
    -- Fire AutoFishing remote ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß
    print("üé£ Firing AutoFishing remote...")
    pcall(function()
        ReplicatedStorage.Remote.Main:FireServer("AutoFishing")
        print("‚úÖ Fired AutoFishing remote")
    end)
    
    isFishing = true
    print("‚úÖ Fishing started successfully!")
end

local function resumeFishing()
    print("üé£ Resuming fishing process...")
    
    -- ‡πÄ‡∏ä‡πá‡∏Ñ‡πÅ‡∏•‡∏∞‡∏´‡∏¢‡∏¥‡∏ö‡πÄ‡∏ö‡πá‡∏î‡∏Å‡πà‡∏≠‡∏ô
    ensureFishingRod()
    task.wait(1)
    
    
    -- Teleport
    teleportToFishingSpot()
    task.wait(2)
    
    -- Fire AutoFishing remote ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß
    print("üé£ Firing AutoFishing remote...")
    pcall(function()
        ReplicatedStorage.Remote.Main:FireServer("AutoFishing")
        print("‚úÖ Fired AutoFishing remote")
    end)
    
    isFishing = true
    print("‚úÖ Fishing resumed successfully!")
end

local function sellSalmon()
    local sellCount = 0
    
    while true do
        local amount = getFishAmount("Salmon")
        
        if amount <= 0 then
            break
        end
        
        sellCount = sellCount + 1
        
        pcall(function()
            local args = {"Seller", "Salmon", amount}
            player.PlayerGui.ECONOMY.ClientHandler.RemoteEvent:FireServer(unpack(args))
        end)
        
        task.wait(2)
        
        if sellCount >= 20 then
            break
        end
    end
end

local function sellAllFish()
    while isTeleporting or isBuyingBait or isBuyingFood do
        task.wait(1)
    end
    
    isSelling = true
    
    local normalFish = {"Octopus", "Seaweed", "Shrimp"}
    
    for i = 1, 3 do
        pcall(function()
            local character = player.Character or player.CharacterAdded:Wait()
            local hrp = character:WaitForChild("HumanoidRootPart")
            local sellPoint = workspace.AMain[" "].HumanoidRootPart
            hrp.CFrame = sellPoint.CFrame
        end)
        task.wait(2)
    end
    
    task.wait(3)
    
    for i = 1, 3 do
        pcall(function()
            local prompt = workspace.AMain[" "].HumanoidRootPart.Attachment.PromptEconomy
            if prompt and prompt:IsA("ProximityPrompt") then
                fireproximityprompt(prompt)
            end
        end)
        task.wait(1)
    end
    
    task.wait(2)
    
    for _, fishName in ipairs(normalFish) do
        local sellCount = 0
        
        while true do
            local amount = getFishAmount(fishName)
            
            if amount <= 0 then
                break
            end
            
            sellCount = sellCount + 1
            
            pcall(function()
                local args = {"Seller", fishName, amount}
                player.PlayerGui.ECONOMY.ClientHandler.RemoteEvent:FireServer(unpack(args))
            end)
            
            task.wait(2)
            
            if sellCount >= 20 then
                break
            end
        end
        
        task.wait(1)
    end
    
    task.wait(2)
    sellSalmon()
    task.wait(2)
    
    pcall(function()
        local args = {"Close"}
        player.PlayerGui.ECONOMY.ClientHandler.RemoteEvent:FireServer(unpack(args))
    end)
    
    task.wait(1)
    isSelling = false
    print("üí∞ Finished selling fish")
end

--========================================================
--                  FOOD SYSTEM (‡πÄ‡∏ä‡πá‡∏Ñ‡∏ã‡πâ‡∏≥‡∏à‡∏ô‡∏Å‡∏ß‡πà‡∏≤‡∏à‡∏∞‡πÄ‡∏ï‡πá‡∏°)      
--========================================================

local function getHunger()
    local hunger = 100
    pcall(function()
        hunger = player.Status.Hunger.Value
    end)
    return hunger
end

local function getBrain()
    local brain = 100
    pcall(function()
        brain = player.Status.Brain.Value
    end)
    return brain
end

local function buyAndEatFood()
    isBuyingFood = true
    
    local SHOP_POSITION = Vector3.new(7794,265, -785)
    
    for i = 1, 3 do
        pcall(function()
            local character = player.Character or player.CharacterAdded:Wait()
            local hrp = character:WaitForChild("HumanoidRootPart")
            hrp.CFrame = CFrame.new(SHOP_POSITION)
        end)
        task.wait(1)
    end
    
    task.wait(1.5)

    pcall(function()
        local character = player.Character
        local hrp = character and character:FindFirstChild("HumanoidRootPart")
        if not hrp then return end

        local targetPrompt = nil
        local shortestDistance = math.huge

        for _, item in ipairs(workspace.AMain.Market_:GetChildren()) do
            local prompt = item:FindFirstChild("MarketPrompt")
            if prompt and prompt:IsA("ProximityPrompt") then
                pcall(function()
                    local promptPos = item:IsA("BasePart") and item.Position or item.WorldPosition
                    local distance = (hrp.Position - promptPos).Magnitude
                    
                    if distance < shortestDistance then
                        shortestDistance = distance
                        targetPrompt = prompt
                    end
                end)
            end
        end

        if targetPrompt then
            fireproximityprompt(targetPrompt)
        end
    end)
    
    task.wait(2)
    
    pcall(function()
        local args = {
            "Money",
            {
                ["Snack bar"] = {
                    Price = 500,
                    Amount = 1
                }
            }
        }
        player.PlayerGui.Shop.LocalScript.RemoteEvent:FireServer(unpack(args))
    end)
    
    task.wait(1)
    
    pcall(function()
        local args = {
            "Money",
            {
                ["Cotton candy"] = {
                    Price = 500,
                    Amount = 1
                }
            }
        }
        player.PlayerGui.Shop.LocalScript.RemoteEvent:FireServer(unpack(args))
    end)
    
    task.wait(1)
    
    pcall(function()
        local args = {"Close"}
        player.PlayerGui.Shop.LocalScript.RemoteEvent:FireServer(unpack(args))
    end)
    
    task.wait(2)
    
    pcall(function()
        local args = {"Hunger", 0, "Cotton candy"}
        game.Lighting:WaitForChild("Sky"):WaitForChild("Optimized"):FireServer(unpack(args))
    end)
    
    task.wait(20)
    
    pcall(function()
        local args = {"Hunger", 10, "Snack bar"}
        game.Lighting:WaitForChild("Sky"):WaitForChild("Optimized"):FireServer(unpack(args))
    end)
    
    task.wait(20)
    
    isBuyingFood = false
end

local function ensureFullHungerBrain()
    print("üçî Checking hunger/brain status...")
    
    while true do
        local hunger = getHunger()
        local brain = getBrain()
        
        print("üìä Current status: Hunger=" .. hunger .. ", Brain=" .. brain)
        
        if hunger > 50 and brain > 50 then
            print("‚úÖ Hunger and Brain are sufficient!")
            break
        else
            print("‚ö†Ô∏è Need more food! Hunger=" .. hunger .. ", Brain=" .. brain)
            print("üõí Buying and eating food...")
            
            buyAndEatFood()
            
            task.wait(3)
            
            print("üîÑ Rechecking hunger/brain status...")
        end
    end
    
    print("‚úÖ Food check complete - returning to fishing")
end

--========================================================
--                  BACKGROUND THREADS                    
--========================================================

-- Anti-AFK System
task.spawn(function()
    while true do
        task.wait(180) -- 3 ‡∏ô‡∏≤‡∏ó‡∏µ
        
        pcall(function()
            local VirtualInputManager = game:GetService("VirtualInputManager")
            
            VirtualInputManager:SendKeyEvent(true, Enum.KeyCode.LeftShift, false, game)
            task.wait(0.1)
            VirtualInputManager:SendKeyEvent(false, Enum.KeyCode.LeftShift, false, game)
            
            print("‚è∞ Anti-AFK triggered (Shift)")
        end)
    end
end)

-- Check hunger and brain
task.spawn(function()
    while true do
        task.wait(30)
        
        if not AutoFarmEnabled or isBuyingFood or isSelling or isTeleporting then
            continue
        end
        
        local hunger = getHunger()
        local brain = getBrain()
        
        if hunger <= 50 or brain <= 50 then
            print("‚ö†Ô∏è Low hunger/brain detected! Hunger=" .. hunger .. ", Brain=" .. brain)
            
            if isFishing then
                toggleFishingRod()
                isFishing = false
                task.wait(1)
            end
            
            ensureFullHungerBrain()

            if AutoFarmEnabled then
                print("üé£ Returning to fishing")
                resumeFishing()
            end
        end
    end
end)

-- Check bait
task.spawn(function()
    while true do
        task.wait(10)
        
        if not AutoFarmEnabled or isBuyingBait or isSelling or isTeleporting or isBuyingFood then
            continue
        end
        
        local baitAmount = getBaitAmount()
        
        if baitAmount < 20 then
            if isFishing then
                toggleFishingRod()
                isFishing = false
                task.wait(1)
            end
            
            buyBait()
            
            if AutoFarmEnabled then
                task.wait(2)
                resumeFishing()
            end
        end
    end
end)

--========================================================
--                  MAIN TAB                              
--========================================================

Tabs.Main:AddParagraph({
    Title = "üé£ Auto Fishing",
    Content = "‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏Å‡∏õ‡∏•‡∏≤‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥\n‚Ä¢ ‡∏ï‡∏Å‡∏õ‡∏•‡∏≤‡∏à‡∏ô‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å 50 KG\n‚Ä¢ ‡∏Ç‡∏≤‡∏¢‡∏õ‡∏•‡∏≤‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥\n‚Ä¢ ‡∏ã‡∏∑‡πâ‡∏≠‡πÄ‡∏´‡∏¢‡∏∑‡πà‡∏≠‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥\n‚Ä¢ ‡∏Å‡∏¥‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥"
})

local AutoFarmToggle = Tabs.Main:AddToggle("AutoFishing", {
    Title = "üöÄ Auto Fishing",
    Description = "‡πÄ‡∏õ‡∏¥‡∏î‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏Å‡∏õ‡∏•‡∏≤‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥",
    Default = _G.CONFIG.AutoFarmOnStart,
    Callback = function(Value)
        AutoFarmEnabled = Value
        
        if Value then
            Fluent:Notify({
                Title = "Auto Fishing",
                Content = "‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏Å‡∏õ‡∏•‡∏≤‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥",
                Duration = 3
            })
            
            task.spawn(function()
                while AutoFarmEnabled do
                    print("üé£ Starting fishing cycle")
                    startFishing()
                    
                    while AutoFarmEnabled do
                        task.wait(2)
                        
                        if isSelling or isTeleporting or isBuyingBait or isBuyingFood then
                            continue
                        end
                        
                        local currentWeight = getCurrentWeight()
                        
                        if currentWeight and currentWeight >= 50 then
                            print("‚ö†Ô∏è Weight limit reached: " .. currentWeight .. " KG")
                            
                            if isFishing then
                                toggleFishingRod()
                                isFishing = false
                                task.wait(2)
                            end
                            
                            print("üí∞ Selling fish...")
                            sellAllFish()
                            task.wait(3)
                            
                            break
                        end
                    end
                    
                    if not AutoFarmEnabled then break end
                    print("üîÑ Cycle complete - Starting new cycle")
                    task.wait(2)
                end
            end)
        else
            Fluent:Notify({
                Title = "Auto Fishing",
                Content = "‡∏´‡∏¢‡∏∏‡∏î‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏Å‡∏õ‡∏•‡∏≤‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥",
                Duration = 3
            })
            
            if isFishing then
                toggleFishingRod()
                isFishing = false
            end
        end
    end
})

--========================================================
--                  INFO TAB                              
--========================================================

Tabs.Info:AddParagraph({
    Title = "üìñ How It Works",
    Content = "1Ô∏è‚É£ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡∏Å‡∏õ‡∏•‡∏≤‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥\n2Ô∏è‚É£ ‡∏ï‡∏Å‡∏õ‡∏•‡∏≤‡∏à‡∏ô‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å 50 KG\n3Ô∏è‚É£ ‡∏Ç‡∏≤‡∏¢‡∏õ‡∏•‡∏≤‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥\n4Ô∏è‚É£ ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏ï‡∏Å‡∏õ‡∏•‡∏≤‡πÉ‡∏´‡∏°‡πà (‡∏ß‡∏ô‡∏ã‡πâ‡∏≥)"
})

Tabs.Info:AddParagraph({
    Title = "üçî Smart Food System",
    Content = "‚Ä¢ ‡πÄ‡∏ä‡πá‡∏Ñ Hunger/Brain ‡∏ó‡∏∏‡∏Å 30 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ\n‚Ä¢ ‡∏ñ‡πâ‡∏≤‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤ 50 ‚Üí ‡∏ã‡∏∑‡πâ‡∏≠‡πÅ‡∏•‡∏∞‡∏Å‡∏¥‡∏ô\n‚Ä¢ ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ã‡πâ‡∏≥‡∏à‡∏ô‡∏Å‡∏ß‡πà‡∏≤‡∏à‡∏∞ > 50\n‚Ä¢ ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏ï‡∏Å‡∏õ‡∏•‡∏≤‡∏ï‡πà‡∏≠‡πÇ‡∏î‡∏¢‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥"
})

Tabs.Info:AddParagraph({
    Title = "‚ú® Features",
    Content = "‚Ä¢ üé£ Auto Fishing\n‚Ä¢ üí∞ Auto Sell Fish\n‚Ä¢ üçî Auto Buy & Eat Food (Loop)\n‚Ä¢ üéØ Auto Buy Bait\n‚Ä¢ ‚è∞ Anti-AFK (Shift Key)"
})

--========================================================
--                  FINAL SETUP                           
--========================================================

if _G.CONFIG.AutoFarmOnStart then
    task.wait(2)
    print("üöÄ [CONFIG] Auto starting fishing system")
    AutoFarmToggle:SetValue(true)
end

Fluent:Notify({
    Title = "‚úÖ Auto Fishing Loaded!",
    Content = "‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏Å‡∏õ‡∏•‡∏≤‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô",
    Duration = 5
})

print("‚úÖ Auto Fishing System Loaded!")
print("üìã Features:")
print("  üé£ Auto Fishing")
print("  üí∞ Auto Sell")
print("  üçî Auto Food (loop until >50)")
print("  üéØ Auto Buy Bait")
print("  ‚è∞ Anti-AFK (Shift)")
